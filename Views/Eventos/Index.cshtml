@model List<EnEscenaMadrid.Models.Evento>
@{
    ViewData["Title"] = "En Escena Madrid - Eventos Culturales";
}

<!-- HEADER PRINCIPAL -->
<header class="app-header">
    <h1 class="app-title">ğŸ­ EN ESCENA MADRID</h1>
    <p class="app-tagline">Todo el teatro en un click</p>
</header>

<div class="container">
    <!-- NAVEGACIÃ“N PRINCIPAL -->
    <nav class="main-nav">
        <div class="nav-tabs">
            <a href="/Eventos" class="nav-tab active">ğŸ“… ESTA SEMANA</a>
            <a href="/Eventos?categoria=teatro" class="nav-tab">ğŸ­ TEATRO</a>
            <a href="/Eventos?categoria=cine" class="nav-tab">ğŸ¬ CINE</a>
            <a href="/Eventos?categoria=exposiciones" class="nav-tab">ğŸ¨ EXPOSICIONES</a>
            <a href="/Eventos?categoria=literatura" class="nav-tab">ğŸ“š LITERATURA</a>
            <a href="/Eventos?categoria=musica" class="nav-tab">ğŸµ MÃšSICA</a>
            <a href="/Eventos?categoria=festivales" class="nav-tab">ğŸ‰ FESTIVALES</a>
            <a href="/Eventos?categoria=infantil" class="nav-tab">ğŸ‘¶ INFANTIL</a>
        </div>
    </nav>

    <!-- INFORMACIÃ“N DEBUG -->
    <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 6px; margin: 20px 0;">
        <h3>ğŸ“Š EstadÃ­sticas</h3>
        <p><strong>Total eventos encontrados:</strong> @Model.Count</p>
        <p><strong>CategorÃ­a actual:</strong> @(ViewBag.CategoriaActual ?? "Todas")</p>
    </div>

    <!-- LISTA DE EVENTOS -->
<main class="theaters-grid">
    @if (ViewBag.TipoVista == "Netflix")
    {
        <!-- VISTA NETFLIX: Por categorÃ­as -->
        @if (ViewBag.EventosPorCategoria != null)
        {
            @foreach (var categoria in (Dictionary<string, List<EnEscenaMadrid.Models.Evento>>)ViewBag.EventosPorCategoria)
            {
                <section class="netflix-category">
                    <h2 class="category-title">@categoria.Key ESTA SEMANA</h2>
                    
                    <div class="netflix-row">
                        @foreach (var evento in categoria.Value)
                        {
                            <article class="netflix-card">
                                <div class="netflix-card-content">
                                    <h3 class="netflix-title">@evento.Titulo</h3>
                                    <div class="netflix-info">
                                        <span class="netflix-time">@evento.FechaFormateada</span>
                                        <span class="netflix-place">ğŸ“ @evento.NombreInstalacion</span>
                                        <span class="netflix-price">ğŸ’° @evento.Precio</span>
                                        @if (evento.NecesitaEntrada)
                                        {
                                            <span class="netflix-ticket">ğŸ« Entrada necesaria</span>
                                        }
                                    </div>
                                </div>
                            </article>
                        }
                    </div>
                </section>
            }
        }
        else
        {
            <div class="theater-card text-center">
                <h2 class="theater-title">ğŸ“… No hay eventos esta semana</h2>
                <p>Vuelve pronto para ver prÃ³ximos eventos.</p>
            </div>
        }
    }
    else
    {
        <!-- VISTA TRADICIONAL: Lista de eventos (para pestaÃ±as) -->
        @if (Model != null && Model.Count > 0)
        {
            @foreach (var evento in Model.Take(10))
            {
                <article class="theater-card">
                    <h2 class="theater-title">@evento.Titulo</h2>
                    
                    <div class="theater-info">
                        <span class="theater-info-label">ğŸ“… Fecha:</span>
                        @evento.FechaEvento.ToString("dd/MM/yyyy") a las @evento.HoraEvento
                    </div>
                    
                    <div class="theater-info">
                        <span class="theater-info-label">ğŸ“ Lugar:</span>
                        @evento.NombreInstalacion
                    </div>
                    
                    <div class="theater-info">
                        <span class="theater-info-label">ğŸ›ï¸ DirecciÃ³n:</span>
                        @evento.DireccionCompleta
                        @if (evento.Latitud.HasValue && evento.Longitud.HasValue)
                        {
                            <text> </text>
                            <a href="https://www.google.com/maps?q=@evento.Latitud,@evento.Longitud" 
                               target="_blank" class="theater-link">
                                (mapa)
                            </a>
                        }
                    </div>
                    
                    <div class="theater-info">
                        <span class="theater-info-label">ğŸ’° Precio:</span>
                        @evento.Precio
                        @if (evento.NecesitaEntrada)
                        {
                            <text> | ğŸ« Entrada necesaria</text>
                        }
                    </div>

                    <div class="theater-info">
                        <span class="theater-info-label">ğŸ“… Fecha inteligente:</span>
                        @evento.FechaFormateada
                    </div>

                    @if (evento.EsEventoLargaDuracion)
                    {
                        <div class="theater-info">
                            <span class="theater-info-label">â³ Tipo:</span>
                            Evento de larga duraciÃ³n
                            @if (!string.IsNullOrEmpty(evento.DiasSemana))
                            {
                                <text> - DÃ­as: @evento.DiasSemana</text>
                            }
                        </div>
                    }
                    
                    <div class="theater-info">
                        <span class="theater-info-label">ğŸ­ Tipo:</span>
                        @evento.Tipo
                    </div>

                    @if (!string.IsNullOrEmpty(evento.ContentUrl))
                    {
                        <div class="theater-info mt-md">
                            <a href="@evento.ContentUrl" target="_blank" class="theater-link">
                                ğŸŒ MÃ¡s informaciÃ³n
                            </a>
                        </div>
                    }
                </article>
            }
        }
        else
        {
            <div class="theater-card text-center">
                <h2 class="theater-title">âŒ No hay eventos disponibles</h2>
                <p>No se pudieron cargar los eventos.</p>
                @if (ViewBag.Error != null)
                {
                    <p style="color: var(--teatro-rojo); margin-top: 1rem;">
                        <strong>Error:</strong> @ViewBag.Error
                    </p>
                }
            </div>
        }
    }
</main>
</div>